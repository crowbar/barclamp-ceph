# config generated for Ceph cluster <%= node[:ceph][:clustername] %> by CHEF - do not modify

[global]
	auth supported = <%= node[:ceph][:defaults][:global][:auth_supported] %>
	keyring = <%= node[:ceph][:defaults][:global][:keyring] %>

# default info
[mon]
	mon data = <%= node[:ceph][:defaults][:mon][:data] %>

[mds]

[osd]
	osd data = <%= node[:ceph][:defaults][:osd][:data] %>
	osd journal = <%= node[:ceph][:defaults][:osd][:journal] %>
	osd journal size = <%= node[:ceph][:defaults][:osd][:journal_size] %>
	fstype = xfs

# per-service-per-node settings
<% @monitors.sort_by { |mon| mon[:name] }.each do |monitor| %>
[mon.<%= "#{monitor[:name]}-#{@clustername}" %>]
	host = <%= monitor[:name] %>
	mon addr = <%=  monitor[:address] %>:6789

<% end unless @monitors.empty? %>

<% @osds.sort_by { |osd| osd[:ceph][:osd][:index] }.each do |osd| %>
[osd.<%= osd[:ceph][:osd][:index] %>]
	host = <%= osd[:hostname] %>
<% end unless @osds.empty? %>

<% @mdss.sort_by { |mds| mds[:hostname] }.each do |mds| %>
[mds.<%= mds[:hostname] %>]
	host = <%= mds[:hostname] %>
<% end unless @mdss.empty? %>

<% @extra_osds_data.sort_by { |osd| osd[:index] }.each do |osd| %>
[osd.<%= osd[:index] %>]
	host = <%= osd[:hostname] %>
        cluster addr = <%= osd[:cluster_addr] %>:<%= osd[:cluster_port] %>
        public addr = <%= osd[:public_addr] %>:<%= osd[:public_port] %>
        devs = <%= osd[:device] %>
<% end %>
